## 语法分析

### 自顶向下分析概述

#### 自顶向下的分析(Top-Down Parsing)
1. 从分析树的顶部(根节点)向底部(叶节点)方向构造分析树
2. 可以看成是从文法开始符号S**推导**出词串w的过程
3. 每一步推导中，都需要做**两个选择**
    * 替换当前句型中的**哪个非终止符**
    * 用该非终结符的**哪个候选式**进行替换

#### 最左推导(Left-most Derivation)
1. 在**最左推导**中，总是选择每个句型的**最左非终结符**进行替换。得到的句型叫**最左句型**;   (从底向上称为最右归约)

#### 最右推导
1. 在**最右推导**中，总是选择每个句型的**最右非终结符**进行替换，得到的句型叫**最右句型**   ()从底向上称为最左归约
2. 在自底向上的分析中，总是采用最左归约的方式，因此把**最左归约**称为**规范归约**，而**最右推导**相应地称为**规范推导**

#### 自定向下的语法分析采用最左推导方式

#### 自顶向下语法分析的通用形式
1. 递归下降分析(Recursive-Descent Parsing)
    1. 由一组**过程**组成,每个过程对应一个**非终结符**
    2. 从文法开始符号S对应的过程开始，其中递归调用文法中其他非终结符对应的过程。如果S对应的过程体恰好扫描了整个输入串，则成功完成语法分析。
    ```
    void A(){
        //选择一个A产生式, A $\rightarrow$$X_1X_2$……$X_k$;
        for(i = i to k){
            if($X_i$是一个非终结符)
                调用过程$X_i$();
            else if($X_i$等于当前的输入符号a)
                读入下一个输入符号; //这一步，如果多个X都以a开头，就可能回溯，这样效率低
            else /*发生了错误*/
        }
    }
    ```
2. 预测分析：递归下降分析技术的一个特例，通过在输入中向前看**固定个数**(通常为1)符号来选择正确的A-产生式。
    * 可以对某些文法构造出向前看k个输入符号的预测分析器，该类文法有时也称为**LL(k)文法类**
    * 预测分析**不需要回溯**，是一种确定的自顶向下分析方法。

## 文法转换

### 左递归文法会使递归下降分析其陷入**无限循环**
1. 左递归：
2. 消除直接左递归  --> 把左递归转换为右递归
A $\rightarrow$ A$\alpha$|$\beta$($\alpha\neq\epsilon$，$\beta$不已A开头)  $\Rightarrow$ [A $\rightarrow\betaA^'$,$A^'\rightarrow\alphaA^'$|$\epsilon$]
3. 消除直接左递归的一般形式

4. 消除间接左递归：先转换为直接左递归，然后再消除直接左递归
5. 消除左递归算法：

6. 提取左公因子(通过改写产生式来**推迟决定**,等读入了足够多的输入，获得足够信息后再做出正确选择)

7. 提取左公因子算法

### LL(1)文法

#### S_文法
1. 预测分析法的工作过程
    1. 从文法开始符号出发，在每一步推导过程中根据当前句型的最左非终结符A和当前输入符号a，选择正确的A-产生式。为保证分析的确定性，选出的候选式必须是唯一的。
2. S_文法(简单的确定性文法)
    1. 每个产生式的右部都以**终结符**开始
    2. 同一终结符的各个候选式的**首终结符**都不同(S_文法**不含$\epsilon$表达式**)
    3. 如果S_文法中有$\epsilon$表达式：如果当前某**非终结符A**与当前**输入符a**不匹配时，若**存在A$\rightarrow\epsilon$**，可以通过检查a是否可以出现在**A的后面**，来决定**是否使用产生式A$\rightarrow\epsilon$**(若文法中无A$\rightarrow\epsilon$,则应报错)
3. 非终结符的后继符号集FOLLOW
4. 产生式的可选集
    1. 产生式A$\rightarrow\beta$的可选集是指可以选用该产生式进行推导时对应的输入符号的集合，记为SELECT(A$\rightarrow\beta$)
        * SELLECT(A$\rightarrow\alpha\beta$)={a}
        * SELECT(A$\rightarrow\epsilon$)=FOLLOW(A)

#### q_文法(由S_进一步得到的，即放宽了$\epsilon$的要求)
1. 每个产生式的右部或为$\epsilon$,或**以终结符开始**
2. 具有相同左部的产生式有**不相交的可选集**(q_文法不含右部以**非终结符**打头的产生式)

#### LL(1)文法